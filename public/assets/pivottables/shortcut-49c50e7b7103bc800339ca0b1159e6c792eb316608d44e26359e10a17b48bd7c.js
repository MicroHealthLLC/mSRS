!function(c,i,a,h){function o(e,t){this.obj=c(e),this.o=c.extend({},c.fn[d].defaults,t),this.objId=this.obj.attr("id"),this.pwCtrls=".jarviswidget-ctrls",this.widget=this.obj.find(this.o.widgets),this.toggleClass=this.o.toggleClass.split("|"),this.editClass=this.o.editClass.split("|"),this.fullscreenClass=this.o.fullscreenClass.split("|"),this.customClass=this.o.customClass.split("|"),this.storage={enabled:this.o.localStorage},this.initialized=!1,this.init()}var d="jarvisWidgets",n=("ontouchstart"in i||i.DocumentTouch&&a instanceof DocumentTouch?"touchstart":"click")+"."+d;o.prototype={_runLoaderWidget:function(e){var t=this;!0===t.o.indicator&&e.parents(t.o.widgets).find(".jarviswidget-loader:first").stop(!0,!0).fadeIn(100).delay(t.o.indicatorTime).fadeOut(100)},_getPastTimestamp:function(e){var t=this,i=new Date(e),a=i.getMonth()+1,o=i.getDate(),s=i.getFullYear(),l=i.getHours(),d=i.getMinutes(),n=i.getUTCSeconds();return a<10&&(a="0"+a),o<10&&(o="0"+o),l<10&&(l="0"+l),d<10&&(d="0"+d),n<10&&(n="0"+n),t.o.timestampFormat.replace(/%d%/g,o).replace(/%m%/g,a).replace(/%y%/g,s).replace(/%h%/g,l).replace(/%i%/g,d).replace(/%s%/g,n)},_loadAjaxFile:function(s,e,t){var l=this;s.find(".widget-body").load(e,function(e,t,i){var a=c(this);if("error"==t&&a.html('<h4 class="alert alert-danger">'+l.o.labelError+"<b> "+i.status+" "+i.statusText+"</b></h4>"),"success"==t){var o=s.find(l.o.timestampPlaceholder);o.length&&o.html(l._getPastTimestamp(new Date)),"function"==typeof l.o.afterLoad&&l.o.afterLoad.call(this,s)}l=null}),this._runLoaderWidget(t)},_loadKeys:function(){var e=this;if(!0===e.o.ajaxnav){var t=location.hash.replace(/^#/,"");e.storage.keySettings="Plugin_settings_"+t+"_"+e.objId,e.storage.keyPosition="Plugin_position_"+t+"_"+e.objId}else if(!1===e.initialized){t=e.o.pageKey||location.pathname;e.storage.keySettings="jarvisWidgets_settings_"+t+"_"+e.objId,e.storage.keyPosition="jarvisWidgets_position_"+t+"_"+e.objId}},_saveSettingsWidget:function(){var e=this,t=e.storage;e._loadKeys();var i=e.obj.find(e.o.widgets).map(function(){var e={};return e.id=c(this).attr("id"),e.style=c(this).attr("data-widget-attstyle"),e.title=c(this).children("header").children("h2").text(),e.hidden="none"==c(this).css("display")?1:0,e.collapsed=c(this).hasClass("jarviswidget-collapsed")?1:0,e}).get(),a=JSON.stringify({widget:i});t.enabled&&t.getKeySettings!=a&&(localStorage.setItem(t.keySettings,a),t.getKeySettings=a),"function"==typeof e.o.onSave&&e.o.onSave.call(this,null,a,t.keySettings)},_savePositionWidget:function(){var e=this,t=e.storage;e._loadKeys();var i=e.obj.find(e.o.grid+".sortable-grid").map(function(){return{section:c(this).children(e.o.widgets).map(function(){return{id:c(this).attr("id")}}).get()}}).get(),a=JSON.stringify({grid:i});t.enabled&&t.getKeyPosition!=a&&(localStorage.setItem(t.keyPosition,a),t.getKeyPosition=a),"function"==typeof e.o.onSave&&e.o.onSave.call(this,a,t.keyPosition)},init:function(){var g=this;if(!g.initialized){if(g._initStorage(g.storage),c("#"+g.objId).length||alert("It looks like your using a class instead of an ID, dont do that!"),!0===g.o.rtl&&c("body").addClass("rtl"),c(g.o.grid).each(function(){c(this).find(g.o.widgets).length&&c(this).addClass("sortable-grid")}),g.storage.enabled&&g.storage.getKeyPosition){var e=JSON.parse(g.storage.getKeyPosition);for(var t in e.grid){var i=g.obj.find(g.o.grid+".sortable-grid").eq(t);for(var a in e.grid[t].section)i.append(c("#"+e.grid[t].section[a].id))}}if(g.storage.enabled&&g.storage.getKeySettings){var o=JSON.parse(g.storage.getKeySettings);for(var t in o.widget){var s=c("#"+o.widget[t].id);o.widget[t].style&&s.removeClassPrefix("jarviswidget-color-").addClass(o.widget[t].style).attr("data-widget-attstyle",""+o.widget[t].style),1==o.widget[t].hidden?s.hide(1):s.show(1).removeAttr("data-widget-hidden"),1==o.widget[t].collapsed&&s.addClass("jarviswidget-collapsed").children("div").hide(1),s.children("header").children("h2").text()!=o.widget[t].title&&s.children("header").children("h2").text(o.widget[t].title)}}if(g.widget.each(function(){var e,t,i,a,o,s,l,d=c(this),n=c(this).children("header");if(!n.parent().attr("role")){!0===d.data("widget-hidden")&&d.hide(),!0===d.data("widget-collapsed")&&d.addClass("jarviswidget-collapsed").children("div").hide(),e=!0===g.o.customButton&&d.data("widget-custombutton")===h&&0!==g.customClass[0].length?'<a href="javascript:void(0);" class="button-icon jarviswidget-custom-btn"><i class="'+g.customClass[0]+'"></i></a>':"",t=!0===g.o.deleteButton&&d.data("widget-deletebutton")===h?'<a href="javascript:void(0);" class="button-icon jarviswidget-delete-btn" rel="tooltip" title="Delete" data-placement="bottom"><i class="'+g.o.deleteClass+'"></i></a>':"",i=!0===g.o.editButton&&d.data("widget-editbutton")===h?'<a href="javascript:void(0);" class="button-icon jarviswidget-edit-btn" rel="tooltip" title="Edit" data-placement="bottom"><i class="'+g.editClass[0]+'"></i></a>':"",a=!0===g.o.fullscreenButton&&d.data("widget-fullscreenbutton")===h?'<a href="javascript:void(0);" class="button-icon jarviswidget-fullscreen-btn" rel="tooltip" title="Fullscreen" data-placement="bottom"><i class="'+g.fullscreenClass[0]+'"></i></a>':"",!0===g.o.colorButton&&d.data("widget-colorbutton")===h?(o='<a data-toggle="dropdown" class="dropdown-toggle color-box selector" href="javascript:void(0);"></a><ul class="dropdown-menu arrow-box-up-right color-select pull-right"><li><span class="bg-color-green" data-widget-setstyle="jarviswidget-color-green" rel="tooltip" data-placement="left" data-original-title="Green Grass"></span></li><li><span class="bg-color-greenDark" data-widget-setstyle="jarviswidget-color-greenDark" rel="tooltip" data-placement="top" data-original-title="Dark Green"></span></li><li><span class="bg-color-greenLight" data-widget-setstyle="jarviswidget-color-greenLight" rel="tooltip" data-placement="top" data-original-title="Light Green"></span></li><li><span class="bg-color-purple" data-widget-setstyle="jarviswidget-color-purple" rel="tooltip" data-placement="top" data-original-title="Purple"></span></li><li><span class="bg-color-magenta" data-widget-setstyle="jarviswidget-color-magenta" rel="tooltip" data-placement="top" data-original-title="Magenta"></span></li><li><span class="bg-color-pink" data-widget-setstyle="jarviswidget-color-pink" rel="tooltip" data-placement="right" data-original-title="Pink"></span></li><li><span class="bg-color-pinkDark" data-widget-setstyle="jarviswidget-color-pinkDark" rel="tooltip" data-placement="left" data-original-title="Fade Pink"></span></li><li><span class="bg-color-blueLight" data-widget-setstyle="jarviswidget-color-blueLight" rel="tooltip" data-placement="top" data-original-title="Light Blue"></span></li><li><span class="bg-color-teal" data-widget-setstyle="jarviswidget-color-teal" rel="tooltip" data-placement="top" data-original-title="Teal"></span></li><li><span class="bg-color-blue" data-widget-setstyle="jarviswidget-color-blue" rel="tooltip" data-placement="top" data-original-title="Ocean Blue"></span></li><li><span class="bg-color-blueDark" data-widget-setstyle="jarviswidget-color-blueDark" rel="tooltip" data-placement="top" data-original-title="Night Sky"></span></li><li><span class="bg-color-darken" data-widget-setstyle="jarviswidget-color-darken" rel="tooltip" data-placement="right" data-original-title="Night"></span></li><li><span class="bg-color-yellow" data-widget-setstyle="jarviswidget-color-yellow" rel="tooltip" data-placement="left" data-original-title="Day Light"></span></li><li><span class="bg-color-orange" data-widget-setstyle="jarviswidget-color-orange" rel="tooltip" data-placement="bottom" data-original-title="Orange"></span></li><li><span class="bg-color-orangeDark" data-widget-setstyle="jarviswidget-color-orangeDark" rel="tooltip" data-placement="bottom" data-original-title="Dark Orange"></span></li><li><span class="bg-color-red" data-widget-setstyle="jarviswidget-color-red" rel="tooltip" data-placement="bottom" data-original-title="Red Rose"></span></li><li><span class="bg-color-redLight" data-widget-setstyle="jarviswidget-color-redLight" rel="tooltip" data-placement="bottom" data-original-title="Light Red"></span></li><li><span class="bg-color-white" data-widget-setstyle="jarviswidget-color-white" rel="tooltip" data-placement="right" data-original-title="Purity"></span></li><li><a href="javascript:void(0);" class="jarviswidget-remove-colors" data-widget-setstyle="" rel="tooltip" data-placement="bottom" data-original-title="Reset widget color to default">Remove</a></li></ul>',n.prepend('<div class="widget-toolbar">'+o+"</div>")):o="",!0===g.o.toggleButton&&d.data("widget-togglebutton")===h?s='<a href="javascript:void(0);" class="button-icon jarviswidget-toggle-btn" rel="tooltip" title="Collapse" data-placement="bottom"><i class="'+(!0===d.data("widget-collapsed")||d.hasClass("jarviswidget-collapsed")?g.toggleClass[1]:g.toggleClass[0])+'"></i></a>':s="",l=!0===g.o.refreshButton&&!1!==d.data("widget-refreshbutton")&&d.data("widget-load")?'<a href="javascript:void(0);" class="button-icon jarviswidget-refresh-btn" data-loading-text="&nbsp;&nbsp;Loading...&nbsp;" rel="tooltip" title="Refresh" data-placement="bottom"><i class="'+g.o.refreshButtonClass+'"></i></a>':"";var r=g.o.buttonOrder.replace(/%refresh%/g,l).replace(/%delete%/g,t).replace(/%custom%/g,e).replace(/%fullscreen%/g,a).replace(/%edit%/g,i).replace(/%toggle%/g,s);(""!==l||""!==t||""!==e||""!==a||""!==i||""!==s)&&n.prepend('<div class="jarviswidget-ctrls">'+r+"</div>"),!0===g.o.sortable&&d.data("widget-sortable")===h&&d.addClass("jarviswidget-sortable"),d.find(g.o.editPlaceholder).length&&d.find(g.o.editPlaceholder).find("input").val(c.trim(n.children("h2").text())),n.append('<span class="jarviswidget-loader"><i class="fa fa-refresh fa-spin"></i></span>'),d.attr("role","widget").children("div").attr("role","content").prev("header").attr("role","heading").children("div").attr("role","menu")}}),!0===g.o.buttonsHidden&&c(g.o.pwCtrls).hide(),c(".jarviswidget header [rel=tooltip]").tooltip(),g.obj.find("[data-widget-load]").each(function(){var e=c(this),t=e.children(),i=e.data("widget-load"),a=1e3*e.data("widget-refresh");e.children(),e.find(".jarviswidget-ajax-placeholder").length||(e.children("widget-body").append('<div class="jarviswidget-ajax-placeholder">'+g.o.loadingLabel+"</div>"),0<e.data("widget-refresh")?(g._loadAjaxFile(e,i,t),c.intervalArr.push(setInterval(function(){g._loadAjaxFile(e,i,t)},a))):g._loadAjaxFile(e,i,t))}),!0===g.o.sortable&&jQuery.ui){var l=g.obj.find(g.o.grid+".sortable-grid").not("[data-widget-excludegrid]");l.sortable({items:l.find(g.o.widgets+".jarviswidget-sortable"),connectWith:l,placeholder:g.o.placeholderClass,cursor:"move",revert:!0,opacity:g.o.opacity,delay:200,cancel:".button-icon, #jarviswidget-fullscreen-mode > div",zIndex:1e4,handle:g.o.dragHandle,forcePlaceholderSize:!0,forceHelperSize:!0,update:function(e,t){g._runLoaderWidget(t.item.children()),g._savePositionWidget(),"function"==typeof g.o.onChange&&g.o.onChange.call(this,t.item)}})}!0===g.o.buttonsHidden&&g.widget.children("header").on("mouseenter."+d,function(){c(this).children(g.o.pwCtrls).stop(!0,!0).fadeTo(100,1)}).on("mouseleave."+d,function(){c(this).children(g.o.pwCtrls).stop(!0,!0).fadeTo(100,0)}),g._clickEvents(),g.storage.enabled&&(c(g.o.deleteSettingsKey).on(n,this,function(e){confirm(g.o.settingsKeyLabel)&&localStorage.removeItem(keySettings),e.preventDefault()}),c(g.o.deletePositionKey).on(n,this,function(e){confirm(g.o.positionKeyLabel)&&localStorage.removeItem(keyPosition),e.preventDefault()})),initialized=!0}},_initStorage:function(e){e.enabled=e.enabled&&!!function(){var e,t=+new Date;try{return localStorage.setItem(t,t),e=localStorage.getItem(t)==t,localStorage.removeItem(t),e}catch(a){}}(),this._loadKeys(),e.enabled&&(e.getKeySettings=localStorage.getItem(e.keySettings),e.getKeyPosition=localStorage.getItem(e.keyPosition))},_clickEvents:function(){function a(){if(c("#jarviswidget-fullscreen-mode").length){var e=c(i).height(),t=c("#jarviswidget-fullscreen-mode").children(s.o.widgets).children("header").height();c("#jarviswidget-fullscreen-mode").children(s.o.widgets).children("div").height(e-t-15)}}var s=this,e=s.widget.children("header");e.on(n,".jarviswidget-toggle-btn",function(e){var t=c(this),i=t.parents(s.o.widgets);s._runLoaderWidget(t),i.hasClass("jarviswidget-collapsed")?t.children().removeClass(s.toggleClass[1]).addClass(s.toggleClass[0]).parents(s.o.widgets).removeClass("jarviswidget-collapsed").children("[role=content]").slideDown(s.o.toggleSpeed,function(){s._saveSettingsWidget()}):t.children().removeClass(s.toggleClass[0]).addClass(s.toggleClass[1]).parents(s.o.widgets).addClass("jarviswidget-collapsed").children("[role=content]").slideUp(s.o.toggleSpeed,function(){s._saveSettingsWidget()}),"function"==typeof s.o.onToggle&&s.o.onToggle.call(this,i),e.preventDefault()}),e.on(n,".jarviswidget-fullscreen-btn",function(e){var t=c(this).parents(s.o.widgets),i=t.children("div");s._runLoaderWidget(c(this)),c("#jarviswidget-fullscreen-mode").length?(c(".nooverflow").removeClass("nooverflow"),t.unwrap("<div>").children("div").removeAttr("style").end().find(".jarviswidget-fullscreen-btn:first").children().removeClass(s.fullscreenClass[1]).addClass(s.fullscreenClass[0]).parents(s.pwCtrls).children("a").show(),i.hasClass("jarviswidget-visible")&&i.hide().removeClass("jarviswidget-visible")):(c("body").addClass("nooverflow"),t.wrap('<div id="jarviswidget-fullscreen-mode"/>').parent().find(".jarviswidget-fullscreen-btn:first").children().removeClass(s.fullscreenClass[0]).addClass(s.fullscreenClass[1]).parents(s.pwCtrls).children("a:not(.jarviswidget-fullscreen-btn)").hide(),i.is(":hidden")&&i.show().addClass("jarviswidget-visible")),a(),"function"==typeof s.o.onFullscreen&&s.o.onFullscreen.call(this,t),e.preventDefault()}),c(i).on("resize."+d,function(){a()}),e.on(n,".jarviswidget-edit-btn",function(e){var t=c(this).parents(s.o.widgets);s._runLoaderWidget(c(this)),t.find(s.o.editPlaceholder).is(":visible")?c(this).children().removeClass(s.editClass[1]).addClass(s.editClass[0]).parents(s.o.widgets).find(s.o.editPlaceholder).slideUp(s.o.editSpeed,function(){s._saveSettingsWidget()}):c(this).children().removeClass(s.editClass[0]).addClass(s.editClass[1]).parents(s.o.widgets).find(s.o.editPlaceholder).slideDown(s.o.editSpeed),"function"==typeof s.o.onEdit&&s.o.onEdit.call(this,t),e.preventDefault()}),c(s.o.editPlaceholder).find("input").keyup(function(){c(this).parents(s.o.widgets).children("header").children("h2").text(c(this).val())}),e.on(n,"[data-widget-setstyle]",function(e){var t=c(this).data("widget-setstyle");c(this).parents(s.o.editPlaceholder).find("[data-widget-setstyle]").each(function(){c(this).data("widget-setstyle")+" "}),c(this).parents(s.o.widgets).attr("data-widget-attstyle",""+t).removeClassPrefix("jarviswidget-color-").addClass(t),s._runLoaderWidget(c(this)),s._saveSettingsWidget(),e.preventDefault()}),e.on(n,".jarviswidget-custom-btn",function(e){var t=c(this).parents(s.o.widgets);s._runLoaderWidget(c(this)),c(this).children("."+s.customClass[0]).length?(c(this).children().removeClass(s.customClass[0]).addClass(s.customClass[1]),"function"==typeof s.o.customStart&&s.o.customStart.call(this,t)):(c(this).children().removeClass(s.customClass[1]).addClass(s.customClass[0]),"function"==typeof s.o.customEnd&&s.o.customEnd.call(this,t)),s._saveSettingsWidget(),e.preventDefault()}),e.on(n,".jarviswidget-delete-btn",function(e){var t=c(this).parents(s.o.widgets),i=t.attr("id"),a=t.children("header").children("h2").text();c.SmartMessageBox?c.SmartMessageBox({title:"<i class='fa fa-times' style='color:#ed1c24'></i> "+s.o.labelDelete+' "'+a+'"',content:s.o.deleteMsg,buttons:"[No][Yes]"},function(e){"Yes"==e&&(s._runLoaderWidget(c(this)),c("#"+i).fadeOut(s.o.deleteSpeed,function(){c(this).remove(),"function"==typeof s.o.onDelete&&s.o.onDelete.call(this,t)}))}):c("#"+i).fadeOut(s.o.deleteSpeed,function(){c(this).remove(),"function"==typeof s.o.onDelete&&s.o.onDelete.call(this,t)}),e.preventDefault()}),e.on(n,".jarviswidget-refresh-btn",function(e){var t=c(this).parents(s.o.widgets),i=t.data("widget-load"),a=t.children(),o=c(this);o.button("loading"),a.addClass("widget-body-ajax-loading"),setTimeout(function(){o.button("reset"),a.removeClass("widget-body-ajax-loading"),s._loadAjaxFile(t,i,a)},1e3),e.preventDefault()}),e=null},destroy:function(){var e=this,t="."+d;e.obj.find(e.o.grid+".sortable-grid").not("[data-widget-excludegrid]").sortable("destroy"),e.widget.children("header").off(t),c(e.o.deleteSettingsKey).off(t),c(e.o.deletePositionKey).off(t),c(i).off(t),e.obj.removeData(d)}},c.fn[d]=function(a){return this.each(function(){var e=c(this),t=e.data(d);if(!t){var i="object"==typeof a&&a;e.data(d,t=new o(this,i))}"string"==typeof a&&t[a]()})},c.fn[d].defaults={grid:"section",widgets:".jarviswidget",localStorage:!0,deleteSettingsKey:"",settingsKeyLabel:"Reset settings?",deletePositionKey:"",positionKeyLabel:"Reset position?",sortable:!0,buttonsHidden:!1,toggleButton:!0,toggleClass:"min-10 | plus-10",toggleSpeed:200,onToggle:function(){},deleteButton:!0,deleteMsg:"Warning: This action cannot be undone",deleteClass:"trashcan-10",deleteSpeed:200,onDelete:function(){},editButton:!0,editPlaceholder:".jarviswidget-editbox",editClass:"pencil-10 | delete-10",editSpeed:200,onEdit:function(){},colorButton:!0,fullscreenButton:!0,fullscreenClass:"fullscreen-10 | normalscreen-10",fullscreenDiff:3,onFullscreen:function(){},customButton:!0,customClass:"",customStart:function(){},customEnd:function(){},buttonOrder:"%refresh% %delete% %custom% %edit% %fullscreen% %toggle%",opacity:1,dragHandle:"> header",placeholderClass:"jarviswidget-placeholder",indicator:!0,indicatorTime:600,ajax:!0,loadingLabel:"loading...",timestampPlaceholder:".jarviswidget-timestamp",timestampFormat:"Last update: %m%/%d%/%y% %h%:%i%:%s%",refreshButton:!0,refreshButtonClass:"refresh-10",labelError:"Sorry but there was a error:",labelUpdated:"Last Update:",labelRefresh:"Refresh",labelDelete:"Delete widget:",afterLoad:function(){},rtl:!1,onChange:function(){},onSave:function(){},ajaxnav:!0},c.fn.removeClassPrefix=function(a){return this.each(function(e,t){var i=t.className.split(" ").map(function(e){return 0===e.indexOf(a)?"":e});t.className=c.trim(i.join(" "))}),this}}(jQuery,window,document);